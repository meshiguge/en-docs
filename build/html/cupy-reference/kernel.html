

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>User-Defined Kernels &mdash; Chainer 1.8.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/modified_theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Chainer 1.8.0 documentation" href="../index.html"/>
        <link rel="up" title="CuPy Reference Manual" href="index.html"/>
        <link rel="next" title="Testing Modules" href="testing.html"/>
        <link rel="prev" title="Kernel binary memoization" href="memoize.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../index.html" class="fa fa-home"> Chainer</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Install Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#before-installing-chainer">Before installing Chainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#install-chainer">Install Chainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#uninstall-chainer">Uninstall Chainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#upgrade-chainer">Upgrade Chainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#reinstall-chainer">Reinstall Chainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#run-chainer-with-docker">Run Chainer with Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#what-recommend-means">What &#8220;recommend&#8221; means?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#faq">FAQ</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Chainer Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/basic.html">Introduction to Chainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/recurrentnet.html">Recurrent Nets and their Computational Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/gpu.html">Using GPU(s) in Chainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/function.html">Define your own function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/type_check.html">Type check</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Chainer Reference Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/core.html">Core functionalities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/util.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/check.html">Assertion and Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/functions.html">Standard Function implementations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/links.html">Standard Link implementations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/optimizers.html">Optimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/serializers.html">Serializers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/function_hooks.html">Function hooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/initializers.html">Weight Initializers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/datasets.html">Dataset examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/iterators.html">Iterator examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/extensions.html">Trainer extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/triggers.html">Trainer triggers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/caffe.html">Caffe Reference Model Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/graph.html">Visualization of Computational Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/environment.html">Environment variables</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">CuPy Reference Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">CuPy Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="ndarray.html">Multi-Dimensional Array (ndarray)</a></li>
<li class="toctree-l2"><a class="reference internal" href="ufunc.html">Universal Functions (ufunc)</a></li>
<li class="toctree-l2"><a class="reference internal" href="routines.html">Routines</a></li>
<li class="toctree-l2"><a class="reference internal" href="generic.html">NumPy-CuPy Generic Code Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="cuda.html">Low-Level CUDA Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="memoize.html">Kernel binary memoization</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">User-Defined Kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">Testing Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="environment.html">Environment variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="difference.html">Difference between CuPy and NumPy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contribution.html">Chainer Contribution Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contribution.html#classification-of-contributions">Classification of Contributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribution.html#release-and-milestone">Release and Milestone</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribution.html#issues-and-prs">Issues and PRs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribution.html#coding-guidelines">Coding Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribution.html#testing-guidelines">Testing Guidelines</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../compatibility.html">API Compatibility Policy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../compatibility.html#targeted-versions">Targeted Versions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../compatibility.html#versioning-and-backward-compatibilities">Versioning and Backward Compatibilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../compatibility.html#processes-to-break-backward-compatibilities">Processes to Break Backward Compatibilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../compatibility.html#experimental-apis">Experimental APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../compatibility.html#supported-backward-compatibility">Supported Backward Compatibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../compatibility.html#model-format-compatibility">Model Format Compatibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../compatibility.html#installation-compatibility">Installation Compatibility</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tips.html">Tips and FAQs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tips.html#it-takes-too-long-time-to-compile-a-computational-graph-can-i-skip-it">It takes too long time to compile a computational graph. Can I skip it?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tips.html#mnist-example-does-not-converge-in-cpu-mode-on-mac-os-x">mnist example does not converge in CPU mode on Mac OS X</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../comparison.html">Comparison with Other Frameworks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../comparison.html#a-table-for-quick-comparison">A table for quick comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="../comparison.html#benchmarks">Benchmarks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../license.html#cupy">CuPy</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Chainer</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">CuPy Reference Manual</a> &raquo;</li>
      
    <li>User-Defined Kernels</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../_sources/cupy-reference/kernel.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="user-defined-kernels">
<span id="udkernel"></span><h1>User-Defined Kernels<a class="headerlink" href="#user-defined-kernels" title="Permalink to this headline">¶</a></h1>
<p>CuPy provides easy ways to define two types of CUDA kernels: elementwise kernels and reduction kernels.
We first describe how to define and call elementwise kernels, and then describe how to define and call reduction kernels.</p>
<div class="section" id="basics-of-elementwise-kernels">
<h2>Basics of elementwise kernels<a class="headerlink" href="#basics-of-elementwise-kernels" title="Permalink to this headline">¶</a></h2>
<p>An elementwise kernel can be defined by the <code class="xref py py-class docutils literal"><span class="pre">ElementwiseKernel</span></code> class.
The instance of this class defines a CUDA kernel which can be invoked by the <code class="docutils literal"><span class="pre">__call__</span></code> method of this instance.</p>
<p>A definition of an elementwise kernel consists of four parts: an input argument list, an output argument list, a loop body code, and the kernel name.
For example, a kernel that computes a squared difference <span class="math">\(f(x, y) = (x - y)^2\)</span> is defined as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">squared_diff</span> <span class="o">=</span> <span class="n">cupy</span><span class="o">.</span><span class="n">ElementwiseKernel</span><span class="p">(</span>
<span class="gp">... </span>   <span class="s">&#39;float32 x, float32 y&#39;</span><span class="p">,</span>
<span class="gp">... </span>   <span class="s">&#39;float32 z&#39;</span><span class="p">,</span>
<span class="gp">... </span>   <span class="s">&#39;z = (x - y) * (x - y)&#39;</span><span class="p">,</span>
<span class="gp">... </span>   <span class="s">&#39;squared_diff&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The argument lists consist of comma-separated argument definitions.
Each argument definition consists of a <em>type specifier</em> and an <em>argument name</em>.
Names of NumPy data types can be used as type specifiers.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">n</span></code>, <code class="docutils literal"><span class="pre">i</span></code>, and names starting with an underscore <code class="docutils literal"><span class="pre">_</span></code> are reserved for the internal use.</p>
</div>
<p>The above kernel can be called on either scalars or arrays with broadcasting:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">cupy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">cupy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">squared_diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">array([[  0.,   0.,   0.,   0.,   0.],</span>
<span class="go">       [ 25.,  25.,  25.,  25.,  25.]], dtype=float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">squared_diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">array([[ 25.,  16.,   9.,   4.,   1.],</span>
<span class="go">       [  0.,   1.,   4.,   9.,  16.]], dtype=float32)</span>
</pre></div>
</div>
<p>Output arguments can be explicitly specified (next to the input arguments):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">cupy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">squared_diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="go">array([[  0.,   0.,   0.,   0.,   0.],</span>
<span class="go">       [ 25.,  25.,  25.,  25.,  25.]], dtype=float32)</span>
</pre></div>
</div>
</div>
<div class="section" id="type-generic-kernels">
<h2>Type-generic kernels<a class="headerlink" href="#type-generic-kernels" title="Permalink to this headline">¶</a></h2>
<p>If a type specifier is one character, then it is treated as a <strong>type placeholder</strong>.
It can be used to define a type-generic kernels.
For example, the above <code class="docutils literal"><span class="pre">squared_diff</span></code> kernel can be made type-generic as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">squared_diff_generic</span> <span class="o">=</span> <span class="n">cupy</span><span class="o">.</span><span class="n">ElementwiseKernel</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;T x, T y&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s">&#39;T z&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s">&#39;z = (x - y) * (x - y)&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s">&#39;squared_diff_generic&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Type placeholders of a same character in the kernel definition indicate the same type.
The actual type of these placeholders is determined by the actual argument type.
The ElementwiseKernel class first checks the output arguments and then the input arguments to determine the actual type.
If no output arguments are given on the kernel invocation, then only the input arguments are used to determine the type.</p>
<p>The type placeholder can be used in the loop body code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">squared_diff_generic</span> <span class="o">=</span> <span class="n">cupy</span><span class="o">.</span><span class="n">ElementwiseKernel</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;T x, T y&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s">&#39;T z&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="sd">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="sd">        T diff = x - y;</span>
<span class="gp">... </span><span class="sd">        z = diff * diff;</span>
<span class="gp">... </span><span class="sd">    &#39;&#39;&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s">&#39;squared_diff_generic&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>More than one type placeholder can be used in a kernel definition.
For example, the above kernel can be further made generic over multiple arguments:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">squared_diff_super_generic</span> <span class="o">=</span> <span class="n">cupy</span><span class="o">.</span><span class="n">ElementwiseKernel</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;X x, Y y&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s">&#39;Z z&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s">&#39;z = (x - y) * (x - y)&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s">&#39;squared_diff_super_generic&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that this kernel requires the output argument explicitly specified, because the type <code class="docutils literal"><span class="pre">Z</span></code> cannot be automatically determined from the input arguments.</p>
</div>
<div class="section" id="raw-argument-specifiers">
<h2>Raw argument specifiers<a class="headerlink" href="#raw-argument-specifiers" title="Permalink to this headline">¶</a></h2>
<p>The ElementwiseKernel class does the indexing with broadcasting automatically, which is useful to define most elementwise computations.
On the other hand, we sometimes want to write a kernel with manual indexing for some arguments.
We can tell the ElementwiseKernel class to use manual indexing by adding the <code class="docutils literal"><span class="pre">raw</span></code> keyword preceding the type specifier.</p>
<p>We can use the special variable <code class="docutils literal"><span class="pre">i</span></code> and method <code class="docutils literal"><span class="pre">_ind.size()</span></code> for the manual indexing.
<code class="docutils literal"><span class="pre">i</span></code> indicates the index within the loop.
<code class="docutils literal"><span class="pre">_ind.size()</span></code> indicates total number of elements to apply the elementwise operation.
Note that it represents the size <strong>after</strong> broadcast operation.</p>
<p>For example, a kernel that adds two vectors with reversing one of them can be written as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">add_reverse</span> <span class="o">=</span> <span class="n">cupy</span><span class="o">.</span><span class="n">ElementwiseKernel</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;T x, raw T y&#39;</span><span class="p">,</span> <span class="s">&#39;T z&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s">&#39;z = x + y[_ind.size() - i - 1]&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s">&#39;add_reverse&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(Note that this is an artificial example and you can write such operation just by <code class="docutils literal"><span class="pre">z</span> <span class="pre">=</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">y[::-1]</span></code> without defining a new kernel).
A raw argument can be used like an array.
The indexing operator <code class="docutils literal"><span class="pre">y[_ind.size()</span> <span class="pre">-</span> <span class="pre">i</span> <span class="pre">-</span> <span class="pre">1]</span></code> involves an indexing computation on <code class="docutils literal"><span class="pre">y</span></code>, so <code class="docutils literal"><span class="pre">y</span></code> can be arbitrarily shaped and strode.</p>
<p>Note that raw arguments are not involved in the broadcasting.
If you want to mark all arguments as <code class="docutils literal"><span class="pre">raw</span></code>, you must specify the <code class="docutils literal"><span class="pre">size</span></code> argument on invocation, which defines the value of <code class="docutils literal"><span class="pre">_ind.size()</span></code>.</p>
</div>
<div class="section" id="reduction-kernels">
<h2>Reduction kernels<a class="headerlink" href="#reduction-kernels" title="Permalink to this headline">¶</a></h2>
<p>Reduction kernels can be defined by the <code class="xref py py-class docutils literal"><span class="pre">ReductionKernel</span></code> class.
We can use it by defining four parts of the kernel code:</p>
<ol class="arabic simple">
<li>Identity value: This value is used for the initial value of reduction.</li>
<li>Mapping expression: It is used for the pre-processing of each element to be reduced.</li>
<li>Reduction expression: It is an operator to reduce the multiple mapped values.
The special variables <code class="docutils literal"><span class="pre">a</span></code> and <code class="docutils literal"><span class="pre">b</span></code> are used for its operands.</li>
<li>Post mapping expression: It is used to transform the resulting reduced values.
The special variable <code class="docutils literal"><span class="pre">a</span></code> is used as its input.
Output should be written to the output parameter.</li>
</ol>
<p>ReductionKernel class automatically inserts other code fragments that are required for an efficient and flexible reduction implementation.</p>
<p>For example, L2 norm along specified axes can be written as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">l2norm_kernel</span> <span class="o">=</span> <span class="n">cupy</span><span class="o">.</span><span class="n">ReductionKernel</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&#39;T x&#39;</span><span class="p">,</span>  <span class="c"># input params</span>
<span class="gp">... </span>    <span class="s">&#39;T y&#39;</span><span class="p">,</span>  <span class="c"># output params</span>
<span class="gp">... </span>    <span class="s">&#39;x * x&#39;</span><span class="p">,</span>  <span class="c"># map</span>
<span class="gp">... </span>    <span class="s">&#39;a + b&#39;</span><span class="p">,</span>  <span class="c"># reduce</span>
<span class="gp">... </span>    <span class="s">&#39;y = sqrt(a)&#39;</span><span class="p">,</span>  <span class="c"># post-reduction map</span>
<span class="gp">... </span>    <span class="s">&#39;0&#39;</span><span class="p">,</span>  <span class="c"># identity value</span>
<span class="gp">... </span>    <span class="s">&#39;l2norm&#39;</span>  <span class="c"># kernel name</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">cupy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;f&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2norm_kernel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([  5.47722578,  15.96871948], dtype=float32)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">raw</span></code> specifier is restricted for usages that the axes to be reduced are put at the head of the shape.
It means, if you want to use <code class="docutils literal"><span class="pre">raw</span></code> specifier for at least one argument, the <code class="docutils literal"><span class="pre">axis</span></code> argument must be <code class="docutils literal"><span class="pre">0</span></code> or a contiguous increasing sequence of integers starting from <code class="docutils literal"><span class="pre">0</span></code>, like <code class="docutils literal"><span class="pre">(0,</span> <span class="pre">1)</span></code>, <code class="docutils literal"><span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">2)</span></code>, etc.</p>
</div>
</div>
<div class="section" id="module-cupy">
<span id="reference"></span><h2>Reference<a class="headerlink" href="#module-cupy" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="testing.html" class="btn btn-neutral float-right" title="Testing Modules">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="memoize.html" class="btn btn-neutral" title="Kernel binary memoization"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Preferred Networks, inc. and Preferred Infrastructure, inc..
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.8.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>